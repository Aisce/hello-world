package test.cfca.sadk.util;

import test.cfca.sadk.testdata.TestReady;
import cfca.sadk.lib.crypto.Session;
import cfca.sadk.util.Signature;

public final class P7Test {

    public static void test1(String[] args) throws Exception {
        Session session = TestReady.openSession();

        Signature signature = new Signature();

        // 非标准的SM2签名值（64字节）
        final String base64P7SignedData = "MIIFiwYJKoZIhvcNAQcCoIIFfDCCBXgCAQExCzAJBgUrDgMCGgUAMIIB5QYJKoZIhvcNAQcBoIIB1gSCAdJ+fH5fc2lnbnRpbWVzdGFtcD0yMDExLzQvMTMgMTI6NDk6NTQuNzczfnx+TWVyY1VybD1+fH5UZXJtQ29kZT1+fH5zaWduYXR1cmU9aW52YWxpZH58fmNuPTM4Q049MDQxQDcyOTAwMDAwMzAzQDIwMDAwMTQ5MzVAMDAwMDAwMDIzMjIzNzczMzVlZDQ3NDFiNzAxNzI2MDhlMjQ1NmU3ODVlfnx+VGVybVNzbj0xMzExMDQyOX58fk1lcmNEdFRtPTIwMTEwNDEzMTEwNDI5fnx+TWVyY2hhbnQgTWFpbnRhaW5PbmU9fnx+TWVyY2hhbnRNYWludGFpblR3bz1+fH5UcmFuQW10PTEuODB+fH5fVWtleURpc3BsYXk9e3t0cmFuc05hbWU65LyB5Lia5pSv5LuYfSx7TWVyY0NvZGU65ZWG5oi35Y+3fSx7QW1vdW50OuaUr+S7mOmHkeminX0se0FjY3RObzrku5jmrL7otKbmiLd9fX58fnRyYW5zTmFtZT1FcGF5fnx+TWVyY0NvZGU9OTkwMTA4MTYwMDA0NDExfnx+QW1vdW50PTEuODB+fH5BY2N0Tm89MDAxODU2OTU0MTM1MDAxMjg4fnx+oIICrzCCAqswggJPoAMCAQICBRACWWmHMAwGCCqBHM9VAYN1BQAwXDELMAkGA1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEbMBkGA1UEAwwSQ0ZDQSBURVNUIFNNMiBPQ0ExMB4XDTE1MTExMzAxNTczNFoXDTE3MTExMzAxNTczNFowbzELMAkGA1UEBhMCQ04xFTATBgNVBAoMDENGQ0EgVEVTVCBDQTERMA8GA1UECwwITG9jYWwgUkExFTATBgNVBAsMDEluZGl2aWR1YWwtMTEfMB0GA1UEAwwWMDUxQHNpY3RvQFozMzMyMjIxMTFAMTBZMBMGByqGSM49AgEGCCqBHM9VAYItA0IABFKw9Le1hzJkMhN0GwZw+h/10UuptWsPeCg3GX8T4YnxdFF6SIwGPo9uFQqaaoo6A4hW3vRhqYM3zKKJXiVi3gWjgegwgeUwHwYDVR0jBBgwFoAUa/4Y2o9COqa4bbMuiIM6NKLBMOEwSAYDVR0gBEEwPzA9BghggRyG7yoBATAxMC8GCCsGAQUFBwIBFiNodHRwOi8vd3d3LmNmY2EuY29tLmNuL3VzL3VzLTE0Lmh0bTA3BgNVHR8EMDAuMCygKqAohiZodHRwOi8vdWNybC5jZmNhLmNvbS5jbi9TTTIvY3JsOTE4LmNybDALBgNVHQ8EBAMCA+gwHQYDVR0OBBYEFF1/aOdx88BykkY0BWaHytdC0kitMBMGA1UdJQQMMAoGCCsGAQUFBwMCMAwGCCqBHM9VAYN1BQADSAAwRQIhANnYcZohtJz4QAtyOLFbDyaf2EFNRF7+JHEs0ZjBFxjpAiBG+6KkFe9coFdHSr1Tub/UyS0B4S3iA/UEKXbInP2pqTGByTCBxgIBATBlMFwxCzAJBgNVBAYTAkNOMTAwLgYDVQQKDCdDaGluYSBGaW5hbmNpYWwgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxGzAZBgNVBAMMEkNGQ0EgVEVTVCBTTTIgT0NBMQIFEAJZaYcwCQYFKw4DAhoFADANBgkqhkiG9w0BAQEFAARAzaocfSpsOLzG52tVYcJaUXEHZOdXawIFhIgy3TCG7prQadWbjeTGoi8WmzFfaJFVfPt4gD/Q1R1sSWfuXePAtw==";
        boolean testResult = signature.p7VerifyMessageAttach(base64P7SignedData.getBytes(), session);
        System.err.println(testResult);
        // SADK工具包当前不支持

    }

    public static void test2(String[] args) throws Exception {
        Session session = TestReady.openSession();

        Signature signature = new Signature();

        final String base64P7SignedData = "MIIFiwYJKoZIhvcNAQcCoIIFfDCCBXgCAQExCzAJBgUrDgMCGgUAMIIB5QYJKoZIhvcNAQcBoIIB1gSCAdJ+fH5fc2lnbnRpbWVzdGFtcD0yMDExLzQvMTMgMTI6NDk6NTQuNzczfnx+TWVyY1VybD1+fH5UZXJtQ29kZT1+fH5zaWduYXR1cmU9aW52YWxpZH58fmNuPTM4Q049MDQxQDcyOTAwMDAwMzAzQDIwMDAwMTQ5MzVAMDAwMDAwMDIzMjIzNzczMzVlZDQ3NDFiNzAxNzI2MDhlMjQ1NmU3ODVlfnx+VGVybVNzbj0xMzExMDQyOX58fk1lcmNEdFRtPTIwMTEwNDEzMTEwNDI5fnx+TWVyY2hhbnQgTWFpbnRhaW5PbmU9fnx+TWVyY2hhbnRNYWludGFpblR3bz1+fH5UcmFuQW10PTEuODB+fH5fVWtleURpc3BsYXk9e3t0cmFuc05hbWU65LyB5Lia5pSv5LuYfSx7TWVyY0NvZGU65ZWG5oi35Y+3fSx7QW1vdW50OuaUr+S7mOmHkeminX0se0FjY3RObzrku5jmrL7otKbmiLd9fX58fnRyYW5zTmFtZT1FcGF5fnx+TWVyY0NvZGU9OTkwMTA4MTYwMDA0NDExfnx+QW1vdW50PTEuODB+fH5BY2N0Tm89MDAxODU2OTU0MTM1MDAxMjg4fnx+oIICrzCCAqswggJPoAMCAQICBRACWWmHMAwGCCqBHM9VAYN1BQAwXDELMAkGA1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEbMBkGA1UEAwwSQ0ZDQSBURVNUIFNNMiBPQ0ExMB4XDTE1MTExMzAxNTczNFoXDTE3MTExMzAxNTczNFowbzELMAkGA1UEBhMCQ04xFTATBgNVBAoMDENGQ0EgVEVTVCBDQTERMA8GA1UECwwITG9jYWwgUkExFTATBgNVBAsMDEluZGl2aWR1YWwtMTEfMB0GA1UEAwwWMDUxQHNpY3RvQFozMzMyMjIxMTFAMTBZMBMGByqGSM49AgEGCCqBHM9VAYItA0IABFKw9Le1hzJkMhN0GwZw+h/10UuptWsPeCg3GX8T4YnxdFF6SIwGPo9uFQqaaoo6A4hW3vRhqYM3zKKJXiVi3gWjgegwgeUwHwYDVR0jBBgwFoAUa/4Y2o9COqa4bbMuiIM6NKLBMOEwSAYDVR0gBEEwPzA9BghggRyG7yoBATAxMC8GCCsGAQUFBwIBFiNodHRwOi8vd3d3LmNmY2EuY29tLmNuL3VzL3VzLTE0Lmh0bTA3BgNVHR8EMDAuMCygKqAohiZodHRwOi8vdWNybC5jZmNhLmNvbS5jbi9TTTIvY3JsOTE4LmNybDALBgNVHQ8EBAMCA+gwHQYDVR0OBBYEFF1/aOdx88BykkY0BWaHytdC0kitMBMGA1UdJQQMMAoGCCsGAQUFBwMCMAwGCCqBHM9VAYN1BQADSAAwRQIhANnYcZohtJz4QAtyOLFbDyaf2EFNRF7+JHEs0ZjBFxjpAiBG+6KkFe9coFdHSr1Tub/UyS0B4S3iA/UEKXbInP2pqTGByTCBxgIBATBlMFwxCzAJBgNVBAYTAkNOMTAwLgYDVQQKDCdDaGluYSBGaW5hbmNpYWwgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxGzAZBgNVBAMMEkNGQ0EgVEVTVCBTTTIgT0NBMQIFEAJZaYcwCQYFKw4DAhoFADANBgkqhkiG9w0BAQEFAARAzaocfSpsOLzG52tVYcJaUXEHZOdXawIFhIgy3TCG7prQadWbjeTGoi8WmzFfaJFVfPt4gD/Q1R1sSWfuXePAtw==";

        boolean testResult = signature.p7VerifyMessageAttach(base64P7SignedData.getBytes(), session);
        System.err.println(testResult);
        // SADK工具包当前不支持

    }
    
    public static void main(String[] args) throws Exception {
        test1(args);
    }

}
